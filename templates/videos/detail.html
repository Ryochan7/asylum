{% extends "videos/base.html" %}
{% load thumbnail %}
{% load videos_tags %}

{% block title %}Video: {{ video.title }} | {{ block.super }}{% endblock %}
{% block extra_xmlns %}xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml"{% endblock %}

{% block meta_tags %}
    {% thumbnail video.photo 200x110 crop as im %}
    <meta property="og:title" content="{{ video.title }}" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://{{ current_site.domain }}{{ video.get_absolute_url }}" />
    {% if im %}
        <meta property="og:image" content="{{ im.url }}" />
    {% else %}
        <meta property="og:image" content="{{ STATIC_URL }}images/default_video.png" />
    {% endif %}
    <meta property="og:site_name" content="{{ current_site.name }}" />
    <meta property="fb:admins" content="738212647" />
    <meta property="og:description" content="{{ video.description }}" />
    <meta name="keywords" content="" />
    <meta name="description" content="{{ video.description }}" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
{% endblock %}
{% load addthis_tags %}

{% block extra_css %}
    {{ block.super }}
    <link href="{{ STATIC_URL }}css/tabs.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        #tabsF {
            width: 560px;
            height: 40px;
            background: none;
            float: none;
        }
        #tabsF ul {
            padding-left: 10px;
        }
        #tabsF a {
            border-bottom: none;
        }
    </style>
{% endblock %}

{% block extra_js %}
    {{ block.super }}
    {% addthis_header %}
    <script type="text/javascript">
        function check_playlist () {
            {% if previous_video %}
            if ($.cookie ("autoplay")) {
                window.location.href = "{{ previous_video.get_absolute_url }}";
            }
            {% endif %}
        }

        function adjacent_paginate () {
            $("#adjacent_videos a.paginate").click (function (e) {
                e.preventDefault ();
                $("#adjacent_videos div.loading").show ();
                var list_block = $("#adjacent_videos ul");
                var parent_block = $("#adjacent_videos");
                list_block.hide ();
                $.get (this.href, function (data) {
                    $("#adjacent_videos div.loading").hide ();
                    parent_block.replaceWith (data);
                    adjacent_paginate ();
                }).error (function () {
                    alert ("Could not complete request");
                });
            });
        }
        $(document).ready (adjacent_paginate);
    </script>
{% endblock %}

{% block breadcrumb %}
    <div id="breadcrumb">
        <ul>
            <li><a href="{% url home_view %}">Home</a></li>
            <li><a href="{% url videos_index %}">Videos</a></li>
            <li><a href="{% url videos_category video.category.slug %}">{{ video.category.title }}</a></li>
            <li>{{ video.title }}</li>
        </ul>
    </div>
{% endblock %}

{% block content_header_title %}{{ video.title }}{% endblock %}
{% block main_content %}
    {% if perms.videos.can_add_video %}
    <div id="edit_link">
        <div id="tabsF">
            <ul>
                <li><a href="{{ video.edit_link }}"><span>Edit</span></a></li>
            </ul>
        </div>
    </div>
    {% endif %}
    <div class="entry">
        <div id="video_detail">
            {{ video.embed_code }}
            <div id="video_info">
                <p class="posted_by">Posted by: tanickl</p>
                <p class="pub_date">Date: {{ video.pub_date|date:"N d, Y" }}</p>
                <p class="category">Category: <a href="{% url videos_category video.category.slug %}">{{ video.category.title }}</a></p>
                <p class="origin">Origin URL: <br/><input type="text" value="{{ video.video_url }}" /></p>
                <a href="#" id="description_link">Show Description</a>
                <div id="description" class="show">
                    <p>{{ video.description|safe }}</p>
                </div>
            </div>
            {% addthis_share %}
            <iframe src="http://www.facebook.com/plugins/like.php?href=http://{{ current_site.domain }}{{ video.get_absolute_url }}"
            scrolling="no" frameborder="0" class="like_button"></iframe>
            <div id="video_options">
                <form method="post" action="">
                    {% csrf_token %}
                    {{ video_options.as_p }}
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready (function () {
            var block = $("div#video_info #description");

            // Hide description div and show description_link
            $("div#video_info a#description_link").show ();
            block.removeClass ("show");

            // Set onclick function
            $("div#video_info a#description_link").click (function (e) {
                e.preventDefault();
                var block = $("div#video_info #description");
                if (!block.hasClass ("show")) {
                    // Display will become shown.
                    $(this).text ("Hide Description");
                }
                else {
                    // Display will become hidden.
                    $(this).text ("Show Description");
                }
                block.toggleClass ("show");
            });
            $("#video_options input#id_autoplay").click (function () {
                if ($(this).attr ("checked")) {
                    $.cookie ("autoplay", "true");
                }
                else {
                    $.cookie ("autoplay", null);
                }
            });
        });
    </script>
    {% adjacent_videos video %}
{% endblock main_content %}

