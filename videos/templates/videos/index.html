{% extends "videos/base.html" %}
{% load mezzanine_tags i18n %}

{% block meta_title %}{% if page %}{{ page.richtextpage.meta_title }}{% else %}Videos{% endif %}{% endblock  %}

{% block extra_js %}
<script type="text/javascript">
var page_loaded = false;

function list_paginate () {
    $(".pagination a").click (function (e) {
        e.preventDefault ();
        page_loaded = true;
        $("#page-content div.loading").show ();
        var block = $("#page-content #video_list_container");
        block.hide ();
        var scroll_offset = $("body").offset().top;
        $("html, body").animate({scrollTop:scroll_offset}, 200);
        var link_save = this.href;
        var sep = (link_save.indexOf("?")===-1)?"?":"&";
        var link_href = link_save + sep + "ajax=true";
        $.get (link_href, function (data) {
            $("#page-content div.loading").hide ();
            block.replaceWith (data);
            history.pushState(null, null, link_save);
            list_paginate ();
        }).error (function () {
            alert ("Could not complete request");
        });
    });
}

$(document).ready (list_paginate);

    $(window).bind('popstate', function() {
        if (page_loaded)
        {    
            $("#page-content div.loading").show ();
            var block = $("#page-content #video_list_container");
            block.hide ();
            var scroll_offset = $("body").offset().top    
            $("html, body").animate({scrollTop:scroll_offset}, 200);
            var link_save = document.location.href;
            var sep = (link_save.indexOf("?")===-1)?"?":"&";
            var link_href = link_save + sep + "ajax=true";
            $.get (link_href, function (data) {
                $("#page-content div.loading").hide ();
                block.replaceWith (data);
                list_paginate ();
            }).error (function () {
                alert ("Could not complete request");
            });
        }
        else
        {
            page_loaded = true;
        }
    });

$(document).ready(function () {
});
</script>
{% endblock extra_js %}

{% block title %}
{% if page %}
{% editable page.title %}{{ page.title }}{% endeditable %}
{% else %}
{% trans "Videos" %}
{% endif %}
{% endblock title %}

